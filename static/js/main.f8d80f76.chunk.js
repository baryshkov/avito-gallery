(this["webpackJsonpavito-gallery"]=this["webpackJsonpavito-gallery"]||[]).push([[0],[,,,,,,function(e,t,n){e.exports=n(19)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),o=n.n(c),s=(n(11),n(1)),m=n.n(s),l=n(2),u=n(5),i=function e(){var t=this;Object(u.a)(this,e),this.API_BASE="https://boiling-refuge-66454.herokuapp.com/images/",this.getAllPreviews=function(){var e;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.awrap(fetch("".concat(t.API_BASE)));case 2:if((e=n.sent).ok){n.next=5;break}throw new Error("Could not fetch ".concat(t.API_BASE,", received an error with response status \n        ").concat(e.status));case 5:return n.abrupt("return",e.json());case 6:case"end":return n.stop()}}))},this.getImageAndComments=function(e){var n;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.awrap(fetch("".concat(t.API_BASE).concat(e)));case 2:if((n=a.sent).ok){a.next=5;break}throw new Error("empty for now");case 5:return a.abrupt("return",n.json());case 6:case"end":return a.stop()}}))},this.postComment=function(e,n,a){var r,c,o;return m.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return r="".concat(t.API_BASE).concat(a,"/comments"),c={name:n,comment:e},s.next=4,m.a.awrap(fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}));case 4:return o=s.sent,s.abrupt("return",o);case 6:case"end":return s.stop()}}))}},p=(n(13),r.a.createElement("svg",{className:"modal__close-button",width:"20",height:"19",viewBox:"0 0 20 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("line",{x1:"1.35355",y1:"0.646447",x2:"19.3536",y2:"18.6464",stroke:"black"}),r.a.createElement("line",{x1:"0.646447",y1:"18.6464",x2:"18.6464",y2:"0.646446",stroke:"black"}))),f=function(e){var t=e.imageId,n=e.onClose,c=e.forwardedRef,o=new i,s=Object(a.useState)(null),u=Object(l.a)(s,2),f=u[0],d=u[1],v=Object(a.useState)(null),E=Object(l.a)(v,2),w=E[0],b=E[1],h=Object(a.useState)(null),g=Object(l.a)(h,2),_=g[0],y=g[1],j=Object(a.useState)(null),k=Object(l.a)(j,2),x=k[0],N=k[1];Object(a.useEffect)((function(){!function(){var e;m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.awrap(o.getImageAndComments(t));case 2:e=n.sent,d(e.url),b(e.comments);case 5:case"end":return n.stop()}}))}()}),[]);var O=function(e){var t=e.target,n=t.value;"name"===t.name?y(n):N(n)},C=w&&0===w.length?r.a.createElement("div",{className:"comments-wrapper__comment"},r.a.createElement("div",{className:"comments-wrapper__comment__text"},"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0432\u044b\u043c!")):null;return r.a.createElement("div",{className:"container",ref:c},r.a.createElement("button",{type:"button",className:"close-button",onClick:n},p),r.a.createElement("img",{className:"image",src:f,alt:"hi-res"}),r.a.createElement("div",{className:"comments-wrapper"},C||w&&w.map((function(e){var t=e.date,n=e.id,a=e.text,c=new Date(t).toLocaleDateString("ru-RU");return r.a.createElement("div",{className:"comments-wrapper__comment",key:n},r.a.createElement("time",{className:"comments-wrapper__comment__date",dateTime:c.split(".").reverse().join("-")},c),r.a.createElement("div",{className:"comments-wrapper__comment__text"},a))}))),r.a.createElement("form",{className:"input-form",onSubmit:function(e){e.preventDefault(),console.table({username:_,userComment:x}),o.postComment(x,_,t)}},r.a.createElement("input",{className:"input-form__name",type:"text",name:"name",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",onChange:O,required:!0}),r.a.createElement("input",{className:"input-form__comment",type:"text",name:"comment",placeholder:"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",onChange:O,required:!0}),r.a.createElement("input",{type:"submit",className:"input-form__button",value:"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"})))},d=(n(14),function(e){var t=e.onClose,n=e.id,c=Object(a.useRef)(null),o=Object(a.useCallback)((function(e){var n={27:function(){e.preventDefault(),t(),window.removeEventListener("keyup",o,!1)}};n[e.keyCode]&&n[e.keyCode]()}),[t]),s=Object(a.useCallback)((function(e){null!==c&&void 0!==c&&(c.current.contains(e.target)||(t(),document.removeEventListener("click",s,!1)))}),[t]);return Object(a.useEffect)((function(){return window.addEventListener("keyup",o,!1),document.addEventListener("click",s,!1),function(){window.removeEventListener("keyup",o,!1),document.removeEventListener("click",s,!1)}}),[o,s]),r.a.createElement("div",{className:"modal"},r.a.createElement(f,{imageId:n,onClose:t,forwardedRef:c}))}),v=(n(15),function(){var e=new i,t=Object(a.useState)(null),n=Object(l.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(!1),u=Object(l.a)(s,2),p=u[0],f=u[1],v=Object(a.useState)(null),E=Object(l.a)(v,2),w=E[0],b=E[1];Object(a.useEffect)((function(){!function(){var t;m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.awrap(e.getAllPreviews());case 2:t=n.sent,o(t);case 4:case"end":return n.stop()}}))}()}),[e]);var h=r.a.createElement("div",{className:"gallery__loading"},"Loading...");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"gallery"},c&&c.map((function(e){var t=e.id,n=e.url;return r.a.createElement("img",{className:"img",key:t,src:n,alt:"preview",onClick:function(){return function(e){b(e),f(!0)}(t)}})}))||h),p&&r.a.createElement(d,{onClose:function(){return f(!1)},id:w}))}),E=(n(16),function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("span",{className:"footer-copyright"},"\xa9 2018-2019"))}),w=(n(17),n(18),function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",{className:"App-header__title"},"TEST APP")),r.a.createElement(v,null),r.a.createElement(E,null))});o.a.render(r.a.createElement(w,null),document.getElementById("root"))}],[[6,1,2]]]);
//# sourceMappingURL=main.f8d80f76.chunk.js.map